<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ø¹Ø¨Ø± OpenRouter</title>
    <style>
        :root { --primary: #6200ea; --bg: #f8f9fa; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; display: flex; flex-direction: column; height: 90vh; }
        .setup-box { background: #fff; padding: 15px; border-radius: 10px; margin-bottom: 10px; border: 2px solid var(--primary); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .setup-box input { width: 80%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; }
        .chat-area { flex: 1; background: #fff; border-radius: 15px; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        #history { flex: 1; padding: 20px; overflow-y: auto; background: #fdfdfd; }
        .msg { padding: 10px 15px; border-radius: 10px; margin-bottom: 10px; max-width: 85%; line-height: 1.6; }
        .user { background: var(--primary); color: #fff; align-self: flex-start; }
        .ai { background: #e0e0e0; color: #333; align-self: flex-end; }
        .input-box { padding: 15px; border-top: 1px solid #eee; display: flex; gap: 10px; }
        input#user-in { flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 8px; }
        button { padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; }
        button:disabled { background: #999; }
    </style>
</head>
<body>

<div class="container">
    <div class="setup-box">
        <strong>ğŸ”‘ Ù…ÙØªØ§Ø­ OpenRouter:</strong>
        <input type="password" id="api-key" placeholder="sk-or-v1-....">
    </div>

    <div class="chat-area">
        <div id="history" style="display: flex; flex-direction: column;">
            <div class="msg ai">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙØªØ§Ø­ OpenRouter Ù„ØªØ´ØºÙŠÙ„ Gemini Ø¨Ø¯ÙˆÙ† Ù‚ÙŠÙˆØ¯ Ø¬ØºØ±Ø§ÙÙŠØ©.</div>
        </div>
        <div class="input-box">
            <input type="text" id="user-in" placeholder="Ø§Ø³Ø£Ù„Ù†ÙŠ Ø£ÙŠ Ø´ÙŠØ¡ ÙÙŠ Ø§Ù„Ù…Ù†Ù‡Ø¬...">
            <button id="send-btn">Ø¥Ø±Ø³Ø§Ù„</button>
        </div>
    </div>
</div>

<script>
    const historyDiv = document.getElementById('history');
    const userIn = document.getElementById('user-in');
    const keyIn = document.getElementById('api-key');
    const btn = document.getElementById('send-btn');

    function addMsg(role, text) {
        const div = document.createElement('div');
        div.className = `msg ${role}`;
        div.innerText = text;
        historyDiv.appendChild(div);
        historyDiv.scrollTop = historyDiv.scrollHeight;
    }

    async function askOpenRouter(question, key) {
        // Ù†Ø³ØªØ®Ø¯Ù… Ù†Ù…ÙˆØ°Ø¬ Gemini 1.5 Flash Ø¹Ø¨Ø± OpenRouter
        const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
            method: "POST",
            headers: {
                "Authorization": `Bearer ${key}`,
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                "model": "google/gemini-flash-1.5", 
                "messages": [{ "role": "user", "content": question }]
            })
        });

        const data = await response.json();
        if (data.error) throw new Error(data.error.message || "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙØªØ§Ø­");
        return data.choices[0].message.content;
    }

    btn.addEventListener('click', async () => {
        const q = userIn.value.trim();
        const k = keyIn.value.trim();
        if (!q || !k) return alert("ØªØ£ÙƒØ¯ Ù…Ù† ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ ÙˆÙˆØ¶Ø¹ Ø§Ù„Ù…ÙØªØ§Ø­!");

        addMsg('user', q);
        userIn.value = '';
        btn.disabled = true;

        try {
            const reply = await askOpenRouter(q, k);
            addMsg('ai', reply);
        } catch (err) {
            addMsg('ai', "Ø®Ø·Ø£: " + err.message);
        } finally {
            btn.disabled = false;
        }
    });
</script>
</body>
</html>
